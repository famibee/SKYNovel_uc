"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkuc"] = self["webpackChunkuc"] || []).push([["vendors-node_modules_famibee_skynovel_dist_app_ReadState_js"],{

/***/ "./node_modules/@famibee/skynovel/dist_app/ReadState.js":
/*!**************************************************************!*\
  !*** ./node_modules/@famibee/skynovel/dist_app/ReadState.js ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   E: () => (/* binding */ D),\n/* harmony export */   I: () => (/* binding */ Pt),\n/* harmony export */   R: () => (/* binding */ c),\n/* harmony export */   T: () => (/* binding */ xt),\n/* harmony export */   a: () => (/* binding */ St),\n/* harmony export */   d: () => (/* binding */ Ot),\n/* harmony export */   e: () => (/* binding */ P),\n/* harmony export */   p: () => (/* binding */ Mt),\n/* harmony export */   r: () => (/* binding */ lt),\n/* harmony export */   u: () => (/* binding */ Ft)\n/* harmony export */ });\n/* harmony import */ var _app2_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./app2.js */ \"./node_modules/@famibee/skynovel/dist_app/app2.js\");\n\nvar D = Object.freeze({\n  Linear: Object.freeze({\n    None: function(e) {\n      return e;\n    },\n    In: function(e) {\n      return e;\n    },\n    Out: function(e) {\n      return e;\n    },\n    InOut: function(e) {\n      return e;\n    }\n  }),\n  Quadratic: Object.freeze({\n    In: function(e) {\n      return e * e;\n    },\n    Out: function(e) {\n      return e * (2 - e);\n    },\n    InOut: function(e) {\n      return (e *= 2) < 1 ? 0.5 * e * e : -0.5 * (--e * (e - 2) - 1);\n    }\n  }),\n  Cubic: Object.freeze({\n    In: function(e) {\n      return e * e * e;\n    },\n    Out: function(e) {\n      return --e * e * e + 1;\n    },\n    InOut: function(e) {\n      return (e *= 2) < 1 ? 0.5 * e * e * e : 0.5 * ((e -= 2) * e * e + 2);\n    }\n  }),\n  Quartic: Object.freeze({\n    In: function(e) {\n      return e * e * e * e;\n    },\n    Out: function(e) {\n      return 1 - --e * e * e * e;\n    },\n    InOut: function(e) {\n      return (e *= 2) < 1 ? 0.5 * e * e * e * e : -0.5 * ((e -= 2) * e * e * e - 2);\n    }\n  }),\n  Quintic: Object.freeze({\n    In: function(e) {\n      return e * e * e * e * e;\n    },\n    Out: function(e) {\n      return --e * e * e * e * e + 1;\n    },\n    InOut: function(e) {\n      return (e *= 2) < 1 ? 0.5 * e * e * e * e * e : 0.5 * ((e -= 2) * e * e * e * e + 2);\n    }\n  }),\n  Sinusoidal: Object.freeze({\n    In: function(e) {\n      return 1 - Math.sin((1 - e) * Math.PI / 2);\n    },\n    Out: function(e) {\n      return Math.sin(e * Math.PI / 2);\n    },\n    InOut: function(e) {\n      return 0.5 * (1 - Math.sin(Math.PI * (0.5 - e)));\n    }\n  }),\n  Exponential: Object.freeze({\n    In: function(e) {\n      return e === 0 ? 0 : Math.pow(1024, e - 1);\n    },\n    Out: function(e) {\n      return e === 1 ? 1 : 1 - Math.pow(2, -10 * e);\n    },\n    InOut: function(e) {\n      return e === 0 ? 0 : e === 1 ? 1 : (e *= 2) < 1 ? 0.5 * Math.pow(1024, e - 1) : 0.5 * (-Math.pow(2, -10 * (e - 1)) + 2);\n    }\n  }),\n  Circular: Object.freeze({\n    In: function(e) {\n      return 1 - Math.sqrt(1 - e * e);\n    },\n    Out: function(e) {\n      return Math.sqrt(1 - --e * e);\n    },\n    InOut: function(e) {\n      return (e *= 2) < 1 ? -0.5 * (Math.sqrt(1 - e * e) - 1) : 0.5 * (Math.sqrt(1 - (e -= 2) * e) + 1);\n    }\n  }),\n  Elastic: Object.freeze({\n    In: function(e) {\n      return e === 0 ? 0 : e === 1 ? 1 : -Math.pow(2, 10 * (e - 1)) * Math.sin((e - 1.1) * 5 * Math.PI);\n    },\n    Out: function(e) {\n      return e === 0 ? 0 : e === 1 ? 1 : Math.pow(2, -10 * e) * Math.sin((e - 0.1) * 5 * Math.PI) + 1;\n    },\n    InOut: function(e) {\n      return e === 0 ? 0 : e === 1 ? 1 : (e *= 2, e < 1 ? -0.5 * Math.pow(2, 10 * (e - 1)) * Math.sin((e - 1.1) * 5 * Math.PI) : 0.5 * Math.pow(2, -10 * (e - 1)) * Math.sin((e - 1.1) * 5 * Math.PI) + 1);\n    }\n  }),\n  Back: Object.freeze({\n    In: function(e) {\n      var t = 1.70158;\n      return e === 1 ? 1 : e * e * ((t + 1) * e - t);\n    },\n    Out: function(e) {\n      var t = 1.70158;\n      return e === 0 ? 0 : --e * e * ((t + 1) * e + t) + 1;\n    },\n    InOut: function(e) {\n      var t = 2.5949095;\n      return (e *= 2) < 1 ? 0.5 * (e * e * ((t + 1) * e - t)) : 0.5 * ((e -= 2) * e * ((t + 1) * e + t) + 2);\n    }\n  }),\n  Bounce: Object.freeze({\n    In: function(e) {\n      return 1 - D.Bounce.Out(1 - e);\n    },\n    Out: function(e) {\n      return e < 1 / 2.75 ? 7.5625 * e * e : e < 2 / 2.75 ? 7.5625 * (e -= 1.5 / 2.75) * e + 0.75 : e < 2.5 / 2.75 ? 7.5625 * (e -= 2.25 / 2.75) * e + 0.9375 : 7.5625 * (e -= 2.625 / 2.75) * e + 0.984375;\n    },\n    InOut: function(e) {\n      return e < 0.5 ? D.Bounce.In(e * 2) * 0.5 : D.Bounce.Out(e * 2 - 1) * 0.5 + 0.5;\n    }\n  }),\n  generatePow: function(e) {\n    return e === void 0 && (e = 4), e = e < Number.EPSILON ? Number.EPSILON : e, e = e > 1e4 ? 1e4 : e, {\n      In: function(t) {\n        return Math.pow(t, e);\n      },\n      Out: function(t) {\n        return 1 - Math.pow(1 - t, e);\n      },\n      InOut: function(t) {\n        return t < 0.5 ? Math.pow(t * 2, e) / 2 : (1 - Math.pow(2 - t * 2, e)) / 2 + 0.5;\n      }\n    };\n  }\n}), m = function() {\n  return performance.now();\n}, Tt = (\n  /** @class */\n  function() {\n    function e() {\n      this._tweens = {}, this._tweensAddedDuringUpdate = {};\n    }\n    return e.prototype.getAll = function() {\n      var t = this;\n      return Object.keys(this._tweens).map(function(i) {\n        return t._tweens[i];\n      });\n    }, e.prototype.removeAll = function() {\n      this._tweens = {};\n    }, e.prototype.add = function(t) {\n      this._tweens[t.getId()] = t, this._tweensAddedDuringUpdate[t.getId()] = t;\n    }, e.prototype.remove = function(t) {\n      delete this._tweens[t.getId()], delete this._tweensAddedDuringUpdate[t.getId()];\n    }, e.prototype.update = function(t, i) {\n      t === void 0 && (t = m()), i === void 0 && (i = !1);\n      var s = Object.keys(this._tweens);\n      if (s.length === 0)\n        return !1;\n      for (; s.length > 0; ) {\n        this._tweensAddedDuringUpdate = {};\n        for (var n = 0; n < s.length; n++) {\n          var r = this._tweens[s[n]], a = !i;\n          r && r.update(t, a) === !1 && !i && delete this._tweens[s[n]];\n        }\n        s = Object.keys(this._tweensAddedDuringUpdate);\n      }\n      return !0;\n    }, e;\n  }()\n), X = {\n  Linear: function(e, t) {\n    var i = e.length - 1, s = i * t, n = Math.floor(s), r = X.Utils.Linear;\n    return t < 0 ? r(e[0], e[1], s) : t > 1 ? r(e[i], e[i - 1], i - s) : r(e[n], e[n + 1 > i ? i : n + 1], s - n);\n  },\n  Utils: {\n    Linear: function(e, t, i) {\n      return (t - e) * i + e;\n    }\n  }\n}, dt = (\n  /** @class */\n  function() {\n    function e() {\n    }\n    return e.nextId = function() {\n      return e._nextId++;\n    }, e._nextId = 0, e;\n  }()\n), Y = new Tt(), xt = (\n  /** @class */\n  function() {\n    function e(t, i) {\n      i === void 0 && (i = Y), this._object = t, this._group = i, this._isPaused = !1, this._pauseStart = 0, this._valuesStart = {}, this._valuesEnd = {}, this._valuesStartRepeat = {}, this._duration = 1e3, this._isDynamic = !1, this._initialRepeat = 0, this._repeat = 0, this._yoyo = !1, this._isPlaying = !1, this._reversed = !1, this._delayTime = 0, this._startTime = 0, this._easingFunction = D.Linear.None, this._interpolationFunction = X.Linear, this._chainedTweens = [], this._onStartCallbackFired = !1, this._onEveryStartCallbackFired = !1, this._id = dt.nextId(), this._isChainStopped = !1, this._propertiesAreSetUp = !1, this._goToEnd = !1;\n    }\n    return e.prototype.getId = function() {\n      return this._id;\n    }, e.prototype.isPlaying = function() {\n      return this._isPlaying;\n    }, e.prototype.isPaused = function() {\n      return this._isPaused;\n    }, e.prototype.getDuration = function() {\n      return this._duration;\n    }, e.prototype.to = function(t, i) {\n      if (i === void 0 && (i = 1e3), this._isPlaying)\n        throw new Error(\"Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.\");\n      return this._valuesEnd = t, this._propertiesAreSetUp = !1, this._duration = i < 0 ? 0 : i, this;\n    }, e.prototype.duration = function(t) {\n      return t === void 0 && (t = 1e3), this._duration = t < 0 ? 0 : t, this;\n    }, e.prototype.dynamic = function(t) {\n      return t === void 0 && (t = !1), this._isDynamic = t, this;\n    }, e.prototype.start = function(t, i) {\n      if (t === void 0 && (t = m()), i === void 0 && (i = !1), this._isPlaying)\n        return this;\n      if (this._group && this._group.add(this), this._repeat = this._initialRepeat, this._reversed) {\n        this._reversed = !1;\n        for (var s in this._valuesStartRepeat)\n          this._swapEndStartRepeatValues(s), this._valuesStart[s] = this._valuesStartRepeat[s];\n      }\n      if (this._isPlaying = !0, this._isPaused = !1, this._onStartCallbackFired = !1, this._onEveryStartCallbackFired = !1, this._isChainStopped = !1, this._startTime = t, this._startTime += this._delayTime, !this._propertiesAreSetUp || i) {\n        if (this._propertiesAreSetUp = !0, !this._isDynamic) {\n          var n = {};\n          for (var r in this._valuesEnd)\n            n[r] = this._valuesEnd[r];\n          this._valuesEnd = n;\n        }\n        this._setupProperties(this._object, this._valuesStart, this._valuesEnd, this._valuesStartRepeat, i);\n      }\n      return this;\n    }, e.prototype.startFromCurrentValues = function(t) {\n      return this.start(t, !0);\n    }, e.prototype._setupProperties = function(t, i, s, n, r) {\n      for (var a in s) {\n        var o = t[a], f = Array.isArray(o), T = f ? \"array\" : typeof o, b = !f && Array.isArray(s[a]);\n        if (!(T === \"undefined\" || T === \"function\")) {\n          if (b) {\n            var _ = s[a];\n            if (_.length === 0)\n              continue;\n            for (var C = [o], p = 0, A = _.length; p < A; p += 1) {\n              var K = this._handleRelativeValue(o, _[p]);\n              if (isNaN(K)) {\n                b = !1, console.warn(\"Found invalid interpolation list. Skipping.\");\n                break;\n              }\n              C.push(K);\n            }\n            b && (s[a] = C);\n          }\n          if ((T === \"object\" || f) && o && !b) {\n            i[a] = f ? [] : {};\n            var R = o;\n            for (var I in R)\n              i[a][I] = R[I];\n            n[a] = f ? [] : {};\n            var _ = s[a];\n            if (!this._isDynamic) {\n              var j = {};\n              for (var I in _)\n                j[I] = _[I];\n              s[a] = _ = j;\n            }\n            this._setupProperties(R, i[a], _, n[a], r);\n          } else\n            (typeof i[a] > \"u\" || r) && (i[a] = o), f || (i[a] *= 1), b ? n[a] = s[a].slice().reverse() : n[a] = i[a] || 0;\n        }\n      }\n    }, e.prototype.stop = function() {\n      return this._isChainStopped || (this._isChainStopped = !0, this.stopChainedTweens()), this._isPlaying ? (this._group && this._group.remove(this), this._isPlaying = !1, this._isPaused = !1, this._onStopCallback && this._onStopCallback(this._object), this) : this;\n    }, e.prototype.end = function() {\n      return this._goToEnd = !0, this.update(1 / 0), this;\n    }, e.prototype.pause = function(t) {\n      return t === void 0 && (t = m()), this._isPaused || !this._isPlaying ? this : (this._isPaused = !0, this._pauseStart = t, this._group && this._group.remove(this), this);\n    }, e.prototype.resume = function(t) {\n      return t === void 0 && (t = m()), !this._isPaused || !this._isPlaying ? this : (this._isPaused = !1, this._startTime += t - this._pauseStart, this._pauseStart = 0, this._group && this._group.add(this), this);\n    }, e.prototype.stopChainedTweens = function() {\n      for (var t = 0, i = this._chainedTweens.length; t < i; t++)\n        this._chainedTweens[t].stop();\n      return this;\n    }, e.prototype.group = function(t) {\n      return t === void 0 && (t = Y), this._group = t, this;\n    }, e.prototype.delay = function(t) {\n      return t === void 0 && (t = 0), this._delayTime = t, this;\n    }, e.prototype.repeat = function(t) {\n      return t === void 0 && (t = 0), this._initialRepeat = t, this._repeat = t, this;\n    }, e.prototype.repeatDelay = function(t) {\n      return this._repeatDelayTime = t, this;\n    }, e.prototype.yoyo = function(t) {\n      return t === void 0 && (t = !1), this._yoyo = t, this;\n    }, e.prototype.easing = function(t) {\n      return t === void 0 && (t = D.Linear.None), this._easingFunction = t, this;\n    }, e.prototype.interpolation = function(t) {\n      return t === void 0 && (t = X.Linear), this._interpolationFunction = t, this;\n    }, e.prototype.chain = function() {\n      for (var t = [], i = 0; i < arguments.length; i++)\n        t[i] = arguments[i];\n      return this._chainedTweens = t, this;\n    }, e.prototype.onStart = function(t) {\n      return this._onStartCallback = t, this;\n    }, e.prototype.onEveryStart = function(t) {\n      return this._onEveryStartCallback = t, this;\n    }, e.prototype.onUpdate = function(t) {\n      return this._onUpdateCallback = t, this;\n    }, e.prototype.onRepeat = function(t) {\n      return this._onRepeatCallback = t, this;\n    }, e.prototype.onComplete = function(t) {\n      return this._onCompleteCallback = t, this;\n    }, e.prototype.onStop = function(t) {\n      return this._onStopCallback = t, this;\n    }, e.prototype.update = function(t, i) {\n      var s = this, n;\n      if (t === void 0 && (t = m()), i === void 0 && (i = !0), this._isPaused)\n        return !0;\n      var r, a = this._startTime + this._duration;\n      if (!this._goToEnd && !this._isPlaying) {\n        if (t > a)\n          return !1;\n        i && this.start(t, !0);\n      }\n      if (this._goToEnd = !1, t < this._startTime)\n        return !0;\n      this._onStartCallbackFired === !1 && (this._onStartCallback && this._onStartCallback(this._object), this._onStartCallbackFired = !0), this._onEveryStartCallbackFired === !1 && (this._onEveryStartCallback && this._onEveryStartCallback(this._object), this._onEveryStartCallbackFired = !0);\n      var o = t - this._startTime, f = this._duration + ((n = this._repeatDelayTime) !== null && n !== void 0 ? n : this._delayTime), T = this._duration + this._repeat * f, b = function() {\n        if (s._duration === 0 || o > T)\n          return 1;\n        var R = Math.trunc(o / f), I = o - R * f, j = Math.min(I / s._duration, 1);\n        return j === 0 && o === s._duration ? 1 : j;\n      }, _ = b(), C = this._easingFunction(_);\n      if (this._updateProperties(this._object, this._valuesStart, this._valuesEnd, C), this._onUpdateCallback && this._onUpdateCallback(this._object, _), this._duration === 0 || o >= this._duration)\n        if (this._repeat > 0) {\n          var p = Math.min(Math.trunc((o - this._duration) / f) + 1, this._repeat);\n          isFinite(this._repeat) && (this._repeat -= p);\n          for (r in this._valuesStartRepeat)\n            !this._yoyo && typeof this._valuesEnd[r] == \"string\" && (this._valuesStartRepeat[r] = // eslint-disable-next-line\n            // @ts-ignore FIXME?\n            this._valuesStartRepeat[r] + parseFloat(this._valuesEnd[r])), this._yoyo && this._swapEndStartRepeatValues(r), this._valuesStart[r] = this._valuesStartRepeat[r];\n          return this._yoyo && (this._reversed = !this._reversed), this._startTime += f * p, this._onRepeatCallback && this._onRepeatCallback(this._object), this._onEveryStartCallbackFired = !1, !0;\n        } else {\n          this._onCompleteCallback && this._onCompleteCallback(this._object);\n          for (var A = 0, K = this._chainedTweens.length; A < K; A++)\n            this._chainedTweens[A].start(this._startTime + this._duration, !1);\n          return this._isPlaying = !1, !1;\n        }\n      return !0;\n    }, e.prototype._updateProperties = function(t, i, s, n) {\n      for (var r in s)\n        if (i[r] !== void 0) {\n          var a = i[r] || 0, o = s[r], f = Array.isArray(t[r]), T = Array.isArray(o), b = !f && T;\n          b ? t[r] = this._interpolationFunction(o, n) : typeof o == \"object\" && o ? this._updateProperties(t[r], a, o, n) : (o = this._handleRelativeValue(a, o), typeof o == \"number\" && (t[r] = a + (o - a) * n));\n        }\n    }, e.prototype._handleRelativeValue = function(t, i) {\n      return typeof i != \"string\" ? i : i.charAt(0) === \"+\" || i.charAt(0) === \"-\" ? t + parseFloat(i) : parseFloat(i);\n    }, e.prototype._swapEndStartRepeatValues = function(t) {\n      var i = this._valuesStartRepeat[t], s = this._valuesEnd[t];\n      typeof s == \"string\" ? this._valuesStartRepeat[t] = this._valuesStartRepeat[t] + parseFloat(s) : this._valuesStartRepeat[t] = this._valuesEnd[t], this._valuesEnd[t] = i;\n    }, e;\n  }()\n);\ndt.nextId;\nvar E = Y;\nE.getAll.bind(E);\nvar St = E.removeAll.bind(E);\nE.add.bind(E);\nvar lt = E.remove.bind(E), Ft = E.update.bind(E);\nlet ct, tt, l, x, g, pt, _t, vt, M, gt = () => {\n}, et, ht, W = !0, S = !1, y = !1, O = !1, h = {}, k = {}, d, v = 0, u = 0, $;\nconst Pt = \"color: yellow; text-shadow: 1px 1px 0 #000, -1px 1px 0 #000, 1px -1px 0 #000, -1px -1px 0 #000;\";\nlet Z = [];\nfunction V() {\n  W || (W = !0, l.setVal_Nochk(\"tmp\", \"sn.tagL.enabled\", !0)), y && (y = !1, l.setVal_Nochk(\"tmp\", \"sn.skip.enabled\", !1)), O && (O = !1, l.setVal_Nochk(\"tmp\", \"sn.auto.enabled\", !1));\n}\nfunction P() {\n  F();\n}\nfunction Ot() {\n  B();\n}\nlet F = () => new q(), B = () => new wt();\nfunction Mt(e, t) {\n  d = JSON.parse(e), v = d.length, u >= v && (u = v - 1), $ = t;\n}\nclass ft {\n  #t = new _app2_js__WEBPACK_IMPORTED_MODULE_0__.E();\n  constructor(t, i) {\n    if (y && !S && !g.isNextKidoku && V(), (0,_app2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"canskip\", !0)) {\n      const s = () => {\n        this.destroy(), V(), i();\n      };\n      this.#t.add(window, \"pointerdown\", (n) => {\n        n.stopPropagation(), s();\n      }), this.#t.add(window, \"keydown\", (n) => {\n        n.isComposing || (n.stopPropagation(), s());\n      }), gt(this.#t, s);\n    }\n  }\n  destroy() {\n    this.#t.clear();\n  }\n}\nclass c {\n  constructor(t) {\n    this.hArg = t, F = () => new q(), B = () => new wt(), ct(this);\n  }\n  static init(t, i, s, n, r, a, o, f, T, b, _) {\n    ct = t, tt = i, l = s, x = n, g = r, pt = a, _t = o, vt = f, M = () => x.goTxt(), gt = T, et = b, ht = _, new q(), l.defTmp(\"sn.tagL.enabled\", () => W), l.defValTrg(\"tmp:sn.tagL.enabled\", (C, p) => W = String(p) !== \"false\"), l.defTmp(\"sn.skip.all\", () => S), l.defValTrg(\"tmp:sn.skip.all\", (C, p) => S = String(p) !== \"false\"), l.defTmp(\"sn.skip.enabled\", () => y), l.defValTrg(\"tmp:sn.skip.enabled\", (C, p) => y = String(p) !== \"false\"), l.defTmp(\"sn.auto.enabled\", () => O), l.defValTrg(\"tmp:sn.auto.enabled\", (C, p) => O = String(p) !== \"false\"), h = {}, k = {};\n  }\n  destroy() {\n    this.onFinish = () => {\n    }, this.onUserAct = () => {\n    }, this.#i.destroy();\n  }\n  get isSkipping() {\n    return y;\n  }\n  static getHtmlElmList(t) {\n    const i = t.indexOf(\":\");\n    let s = \"\";\n    if (i >= 0) {\n      const n = t.slice(4, i), r = `const.sn.frm.${n}`;\n      if (!l.getVal(`tmp:${r}`, 0)) throw `HTML【${n}】が読み込まれていません`;\n      const o = document.getElementById(n).contentWindow;\n      return s = t.slice(i + 1), { el: o.document.querySelectorAll(s), id: n, sel: s };\n    }\n    return s = t.slice(4), { el: document.querySelectorAll(s), id: \"\", sel: s };\n  }\n  static setEvt2Fnc(t, i, s) {\n    t ? k[i] = s : h[i] = s;\n  }\n  static getEvt2Fnc = (t) => h[t] ?? k[t];\n  static clear_eventer(t, i, s) {\n    if (!t.startsWith(\"dom=\")) return;\n    const n = i ? k[s] : h[s];\n    n && c.getHtmlElmList(t).el.forEach((r) => r.removeEventListener(\"click\", n)), i ? delete k[s] : delete h[s];\n  }\n  static clear_event(t) {\n    const i = (0,_app2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"global\", !1), s = i ? k : h;\n    for (const [n, r] of Object.entries(s))\n      n.startsWith(\"dom=\") && c.getHtmlElmList(n).el.forEach((a) => a.removeEventListener(\"click\", r));\n    return i ? k = {} : h = {}, !1;\n  }\n  s(t) {\n    return this.#s(), z.go(t);\n  }\n  wait = (t) => y ? (!S && !g.isNextKidoku && V(), !1) : st.go(t);\n  waitclick = (t) => at.go(t);\n  waitTxtAndTimer(t, i) {\n    return c.#t.once(c.#e, () => {\n      if (this.#i.destroy(), t === 0) {\n        this.onFinish();\n        return;\n      }\n      const s = new xt({}).to({}, t).onComplete(() => {\n        this.#i.destroy(), lt(s), this.onFinish();\n      }).start();\n      this.waitLimitedEvent(i, () => {\n        s.stop(), lt(s), this.onUserAct();\n      });\n    }), M(), l.saveKidoku(), this.waitLimitedEvent(i, () => {\n      c.#t.removeAllListeners(), this.onUserAct();\n    });\n  }\n  static noticeCompTxt() {\n    c.#t.emit(c.#e);\n  }\n  static #t = new _app2_js__WEBPACK_IMPORTED_MODULE_0__.c();\n  // static必須\n  static #e = \"sn:notice_comp_txt\";\n  static popLocalEvts() {\n    const t = h;\n    return h = {}, t;\n  }\n  static pushLocalEvts(t) {\n    h = t;\n  }\n  // 予約イベントの発生待ち\n  waitRsvEvent(t, i) {\n    if (l.saveKidoku(), t ? h.click = //this.hTag.event({key:'enter', breakout: fnc});\n    //hTag.event({key:'down', breakout: fnc});\n    //\thTag.event()は内部で使わず、こうする\n    h.enter = h.arrowdown = // hTag.event({key:'downwheel', breakout: fnc});\n    //\thTag.event()は内部で使わず、こうする\n    h[\"wheel.y>0\"] = () => this.onUserAct() : (delete h.click, delete h.enter, delete h.arrowdown, delete h[\"wheel.y>0\"]), c.getEvt2Fnc = i ? (s) => h[s] ?? k[s] : (s) => h[s], g.noticeWait(), _app2_js__WEBPACK_IMPORTED_MODULE_0__.C.debugLog) {\n      const s = /* @__PURE__ */ Object.create(null);\n      s.local = Object.keys(h), s.global = Object.keys(k), console.log(\"🎍 wait event... %o\", s);\n    }\n  }\n  l(t) {\n    if (!W) return !1;\n    if (this.#s(!0), O) {\n      const i = Number(l.getVal(`sys:sn.auto.msecLineWait${g.isKidoku ? \"_Kidoku\" : \"\"}`));\n      return G.go(i, t);\n    }\n    if (y) {\n      if (!S && !g.isNextKidoku) return N.go(t);\n      if (\"ps\".includes(l.getVal(\"sys:sn.skip.mode\"))) return G.go(50, t);\n    }\n    return nt.go(t);\n  }\n  p(t) {\n    if (this.#s(), O) {\n      const i = Number(l.getVal(`sys:sn.auto.msecPageWait${g.isKidoku ? \"_Kidoku\" : \"\"}`));\n      return H.go(i, t);\n    }\n    if (y) {\n      if (!S && !g.isNextKidoku) return U.go(t);\n      if (l.getVal(\"sys:sn.skip.mode\") == \"s\")\n        return H.go(50, t);\n    }\n    return rt.go(t);\n  }\n  // 予約イベントの発生待ちしない waitRsvEvent()\n  // 使う場合、外部要因でキャンセルした際は breakLimitedEvent() で後始末を忘れないこと\n  waitLimitedEvent(t, i) {\n    return this.#i.destroy(), this.#i = new ft(t, i), !0;\n  }\n  breakEvent(t) {\n    c.evnm === t && (c.evnm = \"\", this.#i.destroy(), P());\n  }\n  #i = new ft({}, () => {\n  });\n  // ':タグ名' は未定義、デバッグ時に無視を\n  static evnm = \"\";\n  // 状態保存する変数はすべて static に\n  waitEvent(t, i, s) {\n    return c.evnm = t, y && !S && !g.isNextKidoku ? Q.go(i, s) : ot.go(i, s);\n  }\n  onFinish() {\n  }\n  onUserAct() {\n  }\n  isWait = !1;\n  // 予約イベントの発生待ち中か\n  fire(t, i) {\n  }\n  page(t) {\n    if (!(\"clear\" in t || \"to\" in t || \"style\" in t)) throw \"clear,style,to いずれかは必須です\";\n    const { style: i } = t;\n    if (i)\n      return $ = i, l.setVal_Nochk(\"save\", \"const.sn.styPaging\", i), !1;\n    if ((0,_app2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"clear\", !1))\n      return d = [], v = 0, u = 0, l.setVal_Nochk(\"sys\", \"const.sn.aPageLog\", \"[]\"), l.setVal_Nochk(\"save\", \"const.sn.styPaging\", Pt), !1;\n    const { to: s, key: n } = t;\n    switch (n && (Z = n.split(\",\")), s) {\n      case \"prev\":\n        if (u = v - 1, v < 2) return !1;\n        break;\n    }\n    return J.go(t);\n  }\n  #s(t = !1) {\n    if (!l.getVal(\"save:sn.doRecLog\")) return;\n    const { fn: i, idx: s } = g.nowScrIdx(), n = `${s - 1}:` + i;\n    if (d.findIndex((a) => a.key === n) > -1) return;\n    d.at(-1)?.week && d.pop();\n    const { max_len: r } = ht.oCfg.log;\n    d.push({\n      key: n,\n      week: t,\n      fn: l.getVal(\"save:const.sn.scriptFn\", i),\n      index: l.getVal(\"save:const.sn.scriptIdx\", 0),\n      mark: g.nowMark()\n    }) > r && (d = d.slice(-r)), v = d.length, l.setVal_Nochk(\"sys\", \"const.sn.aPageLog\", JSON.stringify(d));\n  }\n}\nclass q extends c {\n  constructor() {\n    super({}), tt.resume(), et.hidden = !0;\n  }\n  breakEvent() {\n  }\n}\nclass L extends c {\n  isWait = !0;\n  // 予約イベントの発生待ち中か\n  fire(t, i) {\n    const s = t.toLowerCase();\n    if (_app2_js__WEBPACK_IMPORTED_MODULE_0__.C.debugLog && console.log(`👺 fire<(key:\\`${s}\\` type:${i.type} e:%o)`, { ...i }), s === \"enter\") {\n      const r = vt.getFocus();\n      if (r instanceof _app2_js__WEBPACK_IMPORTED_MODULE_0__.j) {\n        r.emit(\"pointerdown\", new Event(\"pointerdown\"));\n        return;\n      }\n    }\n    const n = c.getEvt2Fnc(s);\n    if (!n) {\n      s.startsWith(\"swipe\") && globalThis.scrollBy(\n        -i.deltaX || 0,\n        // NaN なので ?? ではダメ\n        -i.deltaY || 0\n      );\n      return;\n    }\n    s.endsWith(\"wheel\") || i.preventDefault?.(), i.stopPropagation(), !(!s.startsWith(\"dom=\") && x.clickTxtLay()) && n(i);\n  }\n}\nclass z extends L {\n  static go = (t) => (new z(t).waitTxtAndTimer(0, {}), F = () => {\n  }, !0);\n  breakEvent() {\n  }\n  onFinish() {\n    it.go(this.hArg);\n  }\n  onUserAct() {\n    this.onFinish();\n  }\n}\nclass it extends L {\n  static go = (t) => {\n    V();\n    const i = (0,_app2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"global\", !0);\n    return new it(t).waitRsvEvent(!1, i), F = () => {\n    }, !0;\n  };\n  breakEvent() {\n  }\n  onFinish() {\n  }\n  onUserAct() {\n  }\n}\nclass st extends c {\n  // 文字表示終了待ち→[wait]\n  static go = (t) => {\n    const i = (0,_app2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"time\", NaN);\n    return new st(t).waitTxtAndTimer(i, t);\n  };\n  onFinish() {\n    P();\n  }\n  onUserAct() {\n    this.onFinish();\n  }\n}\nclass nt extends c {\n  // 文字表示終了待ち（そして[l]）\n  static go = (t) => new nt(t).waitTxtAndTimer(0, t);\n  breakEvent() {\n  }\n  onFinish() {\n    N.go(this.hArg);\n  }\n  onUserAct() {\n    this.onFinish();\n  }\n}\nclass G extends c {\n  // 文字表示終了待ち（そして[l]auto/skipウェイト待ち）\n  static go = (t, i) => new G(i).waitTxtAndTimer(t, i);\n  breakEvent() {\n  }\n  onFinish() {\n    P();\n  }\n  onUserAct() {\n    N.go(this.hArg);\n  }\n}\nclass N extends L {\n  // [l] クリック待ち\n  static go = (t) => {\n    (0,_app2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"visible\", !0) && x.breakLine(t), M();\n    const i = (0,_app2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"global\", !0);\n    return new N(t).waitRsvEvent(!0, i), !0;\n  };\n  onFinish() {\n    P();\n  }\n  onUserAct() {\n    P();\n  }\n}\nclass rt extends c {\n  // 文字表示終了待ち（そして[p]）\n  static go = (t) => new rt(t).waitTxtAndTimer(0, t);\n  breakEvent() {\n  }\n  onFinish() {\n    U.go(this.hArg);\n  }\n  onUserAct() {\n    this.onFinish();\n  }\n}\nclass H extends c {\n  // 文字表示終了待ち（そして[p]auto/skipウェイト待ち）\n  static go = (t, i) => new H(i).waitTxtAndTimer(t, i);\n  breakEvent() {\n  }\n  onFinish() {\n    P();\n  }\n  onUserAct() {\n    U.go(this.hArg);\n  }\n}\nclass U extends L {\n  // [p] クリック待ち\n  static go = (t) => {\n    (0,_app2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"visible\", !0) && x.breakPage(t), M();\n    const i = (0,_app2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"global\", !0);\n    return new U(t).waitRsvEvent(!0, i), !0;\n  };\n  onFinish() {\n    (0,_app2_js__WEBPACK_IMPORTED_MODULE_0__.a)(this.hArg, \"er\", !1) && _t.er(this.hArg), pt.clearCache(), P();\n  }\n  onUserAct() {\n    this.onFinish();\n  }\n}\nclass at extends L {\n  static go = (t) => new at(t).waitTxtAndTimer(0, t);\n  onFinish() {\n    V();\n    const t = (0,_app2_js__WEBPACK_IMPORTED_MODULE_0__.a)(this.hArg, \"global\", !0);\n    this.waitRsvEvent(!0, t);\n  }\n  onUserAct() {\n    P();\n  }\n}\nclass ot extends c {\n  constructor(t, i) {\n    super(t), this.onIntr = i;\n  }\n  // 文字表示終了待ち（そして[*]）\n  static go = (t, i) => new ot(t, i).waitTxtAndTimer(0, t);\n  onFinish() {\n    Q.go(this.hArg, this.onIntr);\n  }\n  onUserAct() {\n    this.onFinish();\n  }\n}\nclass Q extends L {\n  constructor(t, i) {\n    super(t), this.onIntr = i;\n  }\n  // fireがある → イベント受付する\n  //class Rs_Any_Wait extends ReadState {\t// fireがない → イベント受付しない\n  static go = (t, i) => new Q(t, i).waitLimitedEvent(t, i);\n  onFinish() {\n    P();\n  }\n  onUserAct() {\n    this.onIntr(), this.onFinish();\n  }\n}\nclass wt extends c {\n  // fireがない → イベント受付しない\n  constructor() {\n    super({}), F = () => new q(), B = () => {\n    };\n  }\n  breakEvent() {\n  }\n}\nclass J extends z {\n  constructor(t) {\n    super(t), F = () => {\n    }, B = () => new Ct();\n  }\n  get isSkipping() {\n    return !d[u]?.week;\n  }\n  // return true で良いのだが、[l]でページ移動モードになったあと、[l]に戻ってモード終了してから、[p]に至る文字表示が瞬時表示になる対策\n  s = (t) => z.go(t);\n  wait = () => !1;\n  waitclick = () => !1;\n  waitTxtAndTimer = () => !1;\n  l(t) {\n    return u === v - 1 ? (this.#e(), N.go(t)) : (x.setAllStyle2TxtLay($), M(), d[u]?.week ? ((0,_app2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"visible\", !0) && x.breakLine(t), this.#t(), !0) : !1);\n  }\n  #t() {\n    this.waitRsvEvent(!1, !0);\n    let t = {};\n    if (Z.length === 0) t = k;\n    else for (const i of Z) {\n      const s = k[i];\n      s && (t[i] = s);\n    }\n    c.getEvt2Fnc = (i) => h[i] ?? t[i];\n  }\n  p(t) {\n    return u === v - 1 ? (this.#e(), U.go(t)) : (x.setAllStyle2TxtLay($), M(), (0,_app2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"visible\", !0) && x.breakPage(t), this.#t(), !0);\n  }\n  static go = (t) => (l.setVal_Nochk(\"tmp\", \"const.sn.isPaging\", !0), new J(t).page(t));\n  page(t) {\n    const { to: i, style: s, clear: n } = t;\n    if (s || n) return !1;\n    switch (i) {\n      case \"prev\":\n        if (u === 0) return !1;\n        --u;\n        break;\n      case \"next\":\n        if (u === v - 1) return !1;\n        ++u;\n        break;\n      case \"exit\":\n        u = v - 1, this.#e();\n        break;\n      case \"load\":\n        v = u + 1, d = d.slice(0, v);\n        break;\n      default:\n        throw `属性to「${i}」は異常です`;\n    }\n    const r = d[u];\n    if (!r) throw `[page] posPage異常:${u}`;\n    const { fn: a, index: o, mark: f } = r;\n    return g.loadFromMark({ fn: a, index: o }, f);\n  }\n  #e() {\n    l.setVal_Nochk(\"tmp\", \"const.sn.isPaging\", !1);\n  }\n  onFinish() {\n  }\n  onUserAct() {\n  }\n}\nclass Ct extends c {\n  // fireがない → イベント受付しない\n  constructor() {\n    super({}), F = () => {\n      new J({}), tt.resume(), et.hidden = !0;\n    }, B = () => {\n    };\n  }\n  breakEvent() {\n  }\n}\n\n//# sourceMappingURL=ReadState.js.map\n\n\n//# sourceURL=webpack://uc/./node_modules/@famibee/skynovel/dist_app/ReadState.js?");

/***/ })

}]);